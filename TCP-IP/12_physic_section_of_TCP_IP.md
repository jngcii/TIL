# TCP/IP 방식의 물리 계층

###### 2020.02.06

- 응용계층, 전송계층, 네트워크 계층에서 생성한 모든 전송 단위는 물리 계층에서 비트 단위로 변환된다.

## TCP/IP 네트워크 환경에서 반드시 알아야 할 3대 네트워크 장비!!!

| 구분 | 관련 계층 | 처리 단위 | 테이블 유무 | 동작 방식 |
| --- | --- | --- | --- | --- |
| 허브 | 물리 | 비트 |  | 플러딩 |
| 스위치 | 데이터 링크 | 프레임 | 스위칭 테이블 | 포워딩/플러딩 |
| 라우터 | 네트워크 | 패킷 | 라우팅 테이블 | 포워딩 |

<br />

>임의의 LAN 영역에 허브와 스위치, 라우터가 UTP 회선을 통해 상호 연결 상태라고 가정
>
>허브의 1번 포트와 4번 포트를 각각 PC와 스위치에 연결
>
>라우터의 이더넷 인터페이스를 스위치에 연결
>
>라우터는 PPP 방식을 통해 상대방 라우터와 WAN 통신



### I. 허브
>물리 계층에서 비트 단위를 처리하는 장치
> 
>비트에서 프레임으로의 디캡슐레이션이 없어 이론상 세대 중 가장 빠르다.

1. PC에서 발생한 비트가 회선을 타고 허브 1번 포트에 도착
2. 1번 포트를 제외한 모든 포트로 비트 단위를 **플러딩**


<br />

### II. 스위치
>데이터 링크 계층에서 프레임 단위를 처리하는 장치
>
>스위치에서 사용하는 테이블 기본 구조
>
>|포트번호 | 맥 주소 |
>|---|---|

1. 허브의 플러딩에 따라 4번 포트를 통해 흘러간 데이터는 스위치의 1번 포트로 흘러간다.
2. 1번 포트에서 비트 단위로 들어온 신호를 수신한 뒤 프레임으로 디캡슐레이션
3. 스위치 운영체제가 프레임 헤더에 담긴 목적지 맥 주소를 자신의 스위칭 테이블에서 검색
4. 만약 검색했다면 프레임을 다시 비트로 변환해 특정 포트로만 비트 신호 **포워딩**
    - 이때 목적지 맥 주소가 있는 포트를 제외한 남은 포트로 비트가 넘치지 않도록 **블로킹**
5. 만약 목적지 맥 주소를 검색할 수 없다면, 허브처럼 **플러딩**



<br />

### III. 라우터
>네트워크 계층에서 패킷 단위를 처리하는 장치
>
>'비트 > 프레임 > 패킷 > 프레임 > 비트'로 인/디캡슐레이션 가능

1. 스위칭 4번 포트로부터 나온 비트는 라우터의 이더넷 인터페이스로 흘러간다.
2. 1번 포트에서 수신한 신호를 프레임으로 변환
3. 자신의 이더넷 인터페이스에 새겨진 맥 주소와 프레임 헤더의 목적지 맥 주소를 비교
4. 일치할 경우 다시 프레임을 패킷으로 변환
5. 라우터 운영체제는 패킷 헤더에 담긴 목적지 IP 주소가 자신의 라우팅 테이블에 있는지 여부를 검사
6. 검색되었다면 해당 경유지로 포워딩하기 위해 패킷을 프레임으로 변환한 뒤, **프레임 헤더에 맥주소가 아닌 PPP 정보를 삽입** (이더넷 헤더가 아닌 PPP 헤더로 변경)

- 라우터가 LAN 영역에서 WAN 영역으로 넘어갈 때의 프레임 헤더 변화

    | 구분 | 전송 단위 | 주요 정보 |
    | --- | --- | --- |
    |LAN 영역 | 이더넷 프레임 | 맥 주소 |
    |WAN 영역 | PPP 프레임 | PPP 정보 |