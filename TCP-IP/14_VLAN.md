# VLAN

###### 2020.02.06

>**V**irtual **L**AN
>
>1개의 물리적 LAN 영역을 여러 개의 논리적인 LAN 영역으로 분할하는 기법

### I. 필요성

- A등급에 해당하는 10.0.0.0 255.0.0.0 대역 같은 경우 하나의 라우터에서 다뤄야 하는 호스트가 약 16,777,216(2^24)개이다.
- 좀더 적은 B등급은 약 65,536개이다.
- 라우터는 라우팅 기능에 전념해야 하는데 이렇게 많은 호스트들의 ARP 요청을 받으면 환장한다.
- 무수한 ARP 요청과 응답에 따른 과부하때문에 라우팅 기능이 불가능할수도 있다.
- **VLAN 기법은 이처럼 대규모의 ARP 영역을 여러개의 소규모 ARP 영역으로 분할하는 것이다.**
    - 방법
    1. 단일 IP 주소 대역을 서브넷 대역으로 분리
    2. 스위칭 장비의 포트에 기반해 각각의 서브넷 대역을 설정


### II. 대역 분할
`192.168.10.0  255.255.255.0 대역을 사용하는 임의의 LAN 영역`

#### 1) 대역 분할 이전


| 호스트 ID 범위 | 프리픽스 | 서브넷 마스크 | 네트워크 IP | 브로드 캐스트 IP |
|---| --- | ---|---|---|---|
|0~255|/24|255.255.255.0|192.168.10.0|192.168.10.255|


- 이 LAN 영역이 클라이언트 집단과 서버 집단으로 이루어졌다고 해보자.
- 클라이언트 집단에서 발생하는 ARP 요청은 동일한 네트워크 ID를 공유하는 서버 집단으로도 넘어간다.
- 이처럼 단일한 ARP 영역에 클라이언트 집단과 서버 집단을 구성한다면 서버로서는 상당한 부담
- 클라이언트와 서버 각각을 위한 ARP 영역으로 구분하면 ARP 요청과 응답의 횟수를 줄일 수 있다.

#### 2) 대역 분할 이후 1


| 호스트 ID 범위 | 프리픽스 | 서브넷 마스크 | 네트워크 IP | 브로드 캐스트 IP |
|---| --- | ---|---|---|---|
|0~127|/25|255.255.255.128|192.168.10.0|192.168.10.127|
|128~255|/25|255.255.255.128|192.168.10.128|192.168.10.255|



#### 3) 대역 분할 이후 2


| 호스트 ID 범위 | 프리픽스 | 서브넷 마스크 | 네트워크 IP | 브로드 캐스트 IP |
|---| --- | ---|---|---|---|
|0~63|/26|255.255.255.192|192.168.10.0|192.168.10.63|
|64~127|/26|255.255.255.192|192.168.10.64|192.168.10.127|
|128~191|/26|255.255.255.192|192.168.10.128|192.168.10.191|
|192~255|/26|255.255.255.192|192.168.10.192|192.168.10.255|


- 프리픽스, 서브넷마스크, 네트워크 IP주소, 브로드 캐스트 IP 주소가 바뀌었다.
- 스위치 장비에서 클라리언트 LAN 영역에 속하는 호스트를 1번 포트부터 20번 포트 사이에 연결하고, 서버 LAN 영역에 속하는 호스트를 21번 포트부터 40번 포트 사이에 연결한 뒤 1~20번 포트까지 VLAN10, 21~40번 포트까지 VLAN20이라고 설정하면 VLAN 구성 완료

>**서브넷** : 1개의 IP 주소 대역을 2의 배수 단위로 나누는 기법
>
>VLAN 환경에서 IP 주소를 가지고 대역을 알 수 있다.
>
>e.g. "IP 주소는 `192.168.10.10` 이고 서브넷 마스크는 `255.255.255.128`이다." 라고 하면 대역이 0~127인걸 알 수 있다.

>**프리픽스** : 1로 표기한 비트의 개수를 이용해 서브넨 상태를 제공하는 표기
>
>| 프리픽스 | 서브넷 이진 | 서브넷 마스크 |
>|---|---|---|
>|/24|1111 1111 . 1111 1111 . 1111 1111 . 0000 0000 | 255.255.255.0 |
>|/25|1111 1111 . 1111 1111 . 1111 1111 . 1000 0000 | 255.255.255.128|
>|/26|1111 1111 . 1111 1111 . 1111 1111 . 1100 0000 | 255.255.255.192|


### III. 특징

- 하나의 VLAN당 호스트 개수가 줄어든다.
- ARP 영역의 개수는 늘어나지만 해당 ARP 영역의 규모는 줄어든다.
- 하나의 컴퓨터에서 ARP 요청을 한다고 다 받을 필요 없이 해당 VLAN의 호스트들만 받으면 된다.
- **ARP 요청과 응답의 빈도가 줄어든다.**
- **내부 통신이므로, 각기 다른 VLAN 영역 사이의 통신 불가**
- 이렇게 논리적으로 분할하기도 하지만, 경우에 따라 **라우팅엔진을 적재해 상이한 VLAN 사이를 라우팅으로 연결하기도 한다.**
- 이를 **인터 VLAN 라우팅** 혹은 **L3스위칭** 이라고 한다.