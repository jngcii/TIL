# ARP 캐시 테이블

###### 2020.02.04

>ARP란 ? IP 주소와 맥 주소 사이를 연결해주는 기능

>termial에 `arp -d` 명령어를 입력한 뒤 `ping 8.8.8.8` 입력
>
>(ping 명령어: 출발지호스트와 목적지 호스트 사이에서 회선의 연결 상태나 목적지 운영체제의 동작 여부 등을 점검하기 위한 도구)
>
>terminal에 `arp -a` 명령어를 입력하면 arp 캐시 저장 정보 볼 수 있다.

### I. ARP 캐시 테이블

- **IP 주소와 맥 주소의 대응 관계를 저장한 테이블**

- LAN 동작을 이해하는데 핵심적인 테이블!

- `arp -d` : 캐시테이블 삭제

- `arp -a` : 모두 출력

### II. ARP 캐시 테이블 채우는 과정 (현재 arp 캐시테이블이 비어있다고 가정)

1. 원하는 주소에 요청을 보낸다. (e.g. 8.8.8.8)

    | 구분 | 출발지 | 목적지 |
    | --- | --- | --- |
    | IP 주소 | 192.168.0.13 | 8.8.8.8 |
    | 맥 주소 | 00-24-1D-DF-8C-47 | |

2. 운영체제는 자기가 사용하는 서브넷 마스크 255.255.255.0을 가지고 출발지와 목적지의 네트워크 ID를 비교한다.

    `192.168.0` != `8.8.8`

3. 네트워크 ID가 다르면 다른 LAN 영역에 있다는 뜻이므로 운영체제는 자시가 사용하는 라우터 IP 주소를 목적지 IP 주소로 변경한다.

    | 구분 | 출발지 | 목적지 |
    | --- | --- | --- |
    | IP 주소 | 192.168.0.13 | 192.168.0.1 |
    | 맥 주소 | 00-24-1D-DF-8C-47 | |

4. 이제 게이트웨이에 해당하는 목적지 맥 주소를 알아야 한다. 그래야 스위칭 통신이 가능하기 때문이다.

5. 그러면 출발지 호스트는 자기와 동일한 네트워크 ID를 사용하는 모든 호스트(LAN영역 전체를 대상으로) 192.168.0.1번에 대응하는 맥 주소를 구하기 위해 ARP 질의를 **브로드캐스트 방식**으로 전송한다.
    >브로드캐스트 방식 : 자신과 동일한 네트워크 ID를 사용하는 모든 호스트에게 데이터를 전송하는 방식

6. 출발지 호스트가 속한 LAN 영역의 모든 호스트는 ARP 질의를 받고 이중에서 192.168.0.1번을 사용하는 게이트웨이가 자신에 대한 맥 주소를 192.168.0.13번에서 요청한다는 사실을 알고 자신의 맥 주소를 **유니캐스트 방식**으로 전송해준다.
    >유니캐스트 방식 : 특정 한 호스트에게 데이터를 전송하는 방식

    | 구분 | 출발지 | 목적지 |
    | --- | --- | --- |
    | IP 주소 | 192.168.0.13 | 192.168.0.1 |
    | 맥 주소 | 00-24-1D-DF-8C-47 | 00-26-66-86-f8-0c|

7. 이렇게 목적지 맥 주소가 ARP 캐시 테이블에 올라오면 운영체제는 ARP 캐시 테이블을 참조해 데이터를 유니캐스트 방식으로 게이트웨이까지 전송한다.

8. 이후 게이트웨이가 IP주소에 기반한 라우팅통신을 통해 8.8.8.8번에 데이터를 전송한다.