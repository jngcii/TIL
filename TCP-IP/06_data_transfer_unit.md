# 데이터 전송 단위

###### 2020.02.04

> 데이터를 전송할 때, 데이터를 **페이로드**, 데이터에 대한 부가 정보를 **헤더**라고 한다.

- 페이로드 : 사용자가 상대방에게 전송하고자 하는 실제 정보가 담긴 공간

- 헤더 : 보내는 사람과 받는 사람의 주소가 담긴 공간

- 운영체제가 전송하는 데이터의 구성

    ![](assets/data_unit_1.png)

### I. 헤더에 다른 데이터

#### 1) 데이터그램 / 세그먼트

- 페이로드만으로 이루어진 데이터 전송 단위 : **메세지**

- 메세지를 생성하면 그 앞에 첫번째 헤더가 붙는다.

- 첫번째 헤더에 담긴 핵심 정보는 **출발지 포트번호**와 **목적지 포트번호**이다.

- 이 헤더가 붙은 데이터 전송 단위를 **데이터 그램**(UDP) 혹은 **세그먼트**(TCP)라고 부른다.

- UDP 프로토콜은 데이터그램 헤더가 붙고, TCP 프로토콜은 세그먼트 헤더가 붙는다.

- 이러한 전송 단위의 차이는 **단편화** 때문인데, TCP방식은 페이로드 영역을 여러개로 조각낸 뒤 각각에 세그먼트 헤더를 붙여서 전송한다(단편화).

    UDP 방식과 TCP 방식의 차이
    |구분 | UDP 방식 | TCP 방식 |
    | --- | --- | --- |
    |페이로드 크기 | 512바이트 미만 | 512바이트 이상 |
    |버퍼링 | 없음 | 있음 |
    |단편화 | 없음 | 있음 |
    |전송 단위 | 데이터그램 | 세그먼트 |

    ![](assets/segment.png)

#### 2) 패킷

- 데이터그램 앞에 붙은 두번째 헤더를 **패킷 헤더**라 한다.

- **출발지 IP 주소**와 **목적지 IP 주소**가 핵심 정보

- 브라우저의 주소창에 도메인 네임을 입력하면 DNS 서비스에 의해 IP 주소로 변환한 뒤 패킷 해더에 담는다.

- 라우팅 장비가 라우팅 기능을 수행할 때 참조하는 부분

    ![](assets/packet.png)

#### 3) 프레임

- 패킷 앞에 붙는 세 번째 헤더를 **프레임 헤더**라 한다.

- **맥 주소**가 담긴다.

- 스위칭 장비가 스위칭 기능을 수행할 때 참조하는 부분

- 스위칭 통신 영역과 라우팅 통신 영역에 있을 때 담는 정보가 다르다.

- LAN 영역에 있을 때는(스위칭 통신) 맥 주소가 있지만, WAN 영역에 있을 때는(라우팅 통신) 다른 무언가로 채워진다.

- 패킷 헤더에서 출발지와 목적지 IP 주소의 네트워크 ID가 다르면 프레임 헤더의 목적지 맥주소는 라우터의 맥 주소를 의미한다.

    ![](assets/frame.png)

#### 4) 비트

- 끝으로 이러한 프레임 단위를 생성한 데이터는 궁극적으로 비트로 변환된다.

- 경우에 따라서 이러한 전송 단위를 단순히 패킷으로 총칭하기도 한다.


II. 인캡슐레이션과 디캡슐레이션

- 인캡슐레이션 : 생성한 페이로드 앞에 헤더를 붙이는 과정

- 디캡슐레이션 : 일련의 헤더를 떼는 과정

- 라우터는 패킷 헤더만 읽을 수 있고, 스위치는 프레임 헤더만 읽을 수 있을 뿐 그 이하는 읽을 수 없다.